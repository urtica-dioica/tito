35feb90ed1d271edca8ea65c6599f180
"use strict";
/**
 * Mock Database Service for Testing
 *
 * This mock service provides the same interface as the real database service
 * but stores data in memory instead of connecting to PostgreSQL.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.mockDatabaseService = exports.MockDatabaseService = void 0;
class MockDatabaseService {
    constructor() {
        this.data = {};
        this.sequenceCounters = {};
        this.initializeSequences();
    }
    initializeSequences() {
        // Initialize sequence counters
        this.sequenceCounters = {
            users_id_seq: 1,
            departments_id_seq: 1,
            employees_id_seq: 1,
            attendance_records_id_seq: 1,
            attendance_sessions_id_seq: 1,
            time_correction_requests_id_seq: 1,
            overtime_requests_id_seq: 1,
            leaves_id_seq: 1,
            leave_balances_id_seq: 1,
            payroll_periods_id_seq: 1,
            payroll_records_id_seq: 1,
            payroll_deductions_id_seq: 1,
            deduction_types_id_seq: 1,
            payroll_approvals_id_seq: 1,
            system_settings_id_seq: 1,
            id_cards_id_seq: 1
        };
        // Initialize table data
        this.data = {
            users: {},
            departments: {},
            employees: {},
            attendance_records: {},
            attendance_sessions: {},
            time_correction_requests: {},
            overtime_requests: {},
            leaves: {},
            leave_balances: {},
            payroll_periods: {},
            payroll_records: {},
            payroll_deductions: {},
            deduction_types: {},
            payroll_approvals: {},
            system_settings: {},
            id_cards: {}
        };
    }
    // Event emitter methods
    on(_event, _callback) {
        // Mock event emitter - do nothing for tests
    }
    // Connection methods
    async connect() {
        return {
            query: this.query.bind(this),
            release: () => { }
        };
    }
    async query(query, values = []) {
        const normalizedQuery = query.trim().toLowerCase();
        // Handle INSERT queries
        if (normalizedQuery.startsWith('insert into')) {
            return this.handleInsert(query, values);
        }
        // Handle SELECT queries
        if (normalizedQuery.startsWith('select')) {
            return this.handleSelect(query, values);
        }
        // Handle UPDATE queries
        if (normalizedQuery.startsWith('update')) {
            return this.handleUpdate(query, values);
        }
        // Handle DELETE queries
        if (normalizedQuery.startsWith('delete')) {
            return this.handleDelete(query, values);
        }
        // Handle ALTER SEQUENCE queries
        if (normalizedQuery.startsWith('alter sequence')) {
            return this.handleAlterSequence(query, values);
        }
        // Handle SET queries
        if (normalizedQuery.startsWith('set')) {
            return { rows: [], rowCount: 0 };
        }
        // Default response for other queries
        return { rows: [], rowCount: 0 };
    }
    handleInsert(query, values) {
        // Extract table name from INSERT query
        const tableMatch = query.match(/insert into\s+(\w+)/i);
        if (!tableMatch) {
            return { rows: [], rowCount: 0 };
        }
        const tableName = tableMatch[1];
        // Generate ID if not provided
        const id = this.generateId(tableName);
        // Create row data
        const row = { id };
        // Map values to columns (simplified - assumes values are in order)
        const columnMatch = query.match(/insert into\s+\w+\s*\(([^)]+)\)/i);
        if (columnMatch) {
            const columns = columnMatch[1].split(',').map(col => col.trim());
            columns.forEach((column, index) => {
                if (values[index] !== undefined) {
                    row[column] = values[index];
                }
            });
        }
        // Store in mock data
        this.data[tableName][id] = row;
        // Return the inserted row
        return { rows: [row], rowCount: 1 };
    }
    handleSelect(query, values) {
        console.log('handleSelect called with query:', query);
        console.log('query.includes("count(*)"):', query.includes('count(*)'));
        // Handle COUNT(*) queries
        if (query.includes('count(*)')) {
            const tableMatch = query.match(/from\s+(\w+)/i);
            if (!tableMatch) {
                return { rows: [{ count: '0' }], rowCount: 1 };
            }
            const tableName = tableMatch[1];
            const tableData = this.data[tableName] || {};
            let count = Object.keys(tableData).length;
            // Handle WHERE clauses for COUNT
            if (query.includes('where')) {
                let rows = Object.values(tableData);
                // Handle WHERE status = $1
                if (query.includes('where status = $1') && values[0]) {
                    rows = rows.filter(row => row.status === values[0]);
                }
                // Handle WHERE employee_id = $1
                if (query.includes('where employee_id = $1') && values[0]) {
                    rows = rows.filter(row => row.employee_id === values[0]);
                }
                count = rows.length;
            }
            return { rows: [{ count: count.toString() }], rowCount: 1 };
        }
        // Extract table name from SELECT query
        const tableMatch = query.match(/from\s+(\w+)/i);
        if (!tableMatch) {
            return { rows: [], rowCount: 0 };
        }
        const tableName = tableMatch[1];
        const tableData = this.data[tableName] || {};
        // Simple WHERE clause handling
        let rows = Object.values(tableData);
        // Handle WHERE id = $1
        if (query.includes('where id = $1') && values[0]) {
            rows = rows.filter(row => row.id === values[0]);
        }
        // Handle WHERE email = $1
        if (query.includes('where email = $1') && values[0]) {
            rows = rows.filter(row => row.email === values[0]);
        }
        // Handle WHERE status = $1
        if (query.includes('where status = $1') && values[0]) {
            rows = rows.filter(row => row.status === values[0]);
        }
        // Handle WHERE employee_id = $1
        if (query.includes('where employee_id = $1') && values[0]) {
            rows = rows.filter(row => row.employee_id === values[0]);
        }
        // Handle WHERE attendance_record_id = $1
        if (query.includes('where attendance_record_id = $1') && values[0]) {
            rows = rows.filter(row => row.attendance_record_id === values[0]);
        }
        // Handle WHERE date = $1
        if (query.includes('where date = $1') && values[0]) {
            rows = rows.filter(row => row.date === values[0]);
        }
        // Handle ORDER BY
        if (query.includes('order by')) {
            if (query.includes('order by first_name, last_name')) {
                rows.sort((a, b) => {
                    const nameA = `${a.first_name || ''} ${a.last_name || ''}`.trim();
                    const nameB = `${b.first_name || ''} ${b.last_name || ''}`.trim();
                    return nameA.localeCompare(nameB);
                });
            }
        }
        // Handle LIMIT
        if (query.includes('limit')) {
            const limitMatch = query.match(/limit\s+(\d+)/i);
            if (limitMatch) {
                const limit = parseInt(limitMatch[1]);
                rows = rows.slice(0, limit);
            }
        }
        return { rows, rowCount: rows.length };
    }
    handleUpdate(query, values) {
        // Extract table name from UPDATE query
        const tableMatch = query.match(/update\s+(\w+)/i);
        if (!tableMatch) {
            return { rows: [], rowCount: 0 };
        }
        const tableName = tableMatch[1];
        const tableData = this.data[tableName] || {};
        // Handle WHERE id = $1
        if (query.includes('where id = $1') && values[0]) {
            const id = values[0];
            if (tableData[id]) {
                // Update the row (simplified - assumes SET clause is at the end)
                const setMatch = query.match(/set\s+(.+?)\s+where/i);
                if (setMatch) {
                    const setClause = setMatch[1];
                    const updates = setClause.split(',').map(update => update.trim());
                    updates.forEach(update => {
                        const [column, value] = update.split('=').map(part => part.trim());
                        if (value.startsWith('$')) {
                            const paramIndex = parseInt(value.substring(1)) - 1;
                            if (values[paramIndex] !== undefined) {
                                tableData[id][column] = values[paramIndex];
                            }
                        }
                    });
                }
                return { rows: [tableData[id]], rowCount: 1 };
            }
        }
        return { rows: [], rowCount: 0 };
    }
    handleDelete(query, values) {
        // Extract table name from DELETE query
        const tableMatch = query.match(/delete from\s+(\w+)/i);
        if (!tableMatch) {
            return { rows: [], rowCount: 0 };
        }
        const tableName = tableMatch[1];
        const tableData = this.data[tableName] || {};
        // Handle WHERE id = $1
        if (query.includes('where id = $1') && values[0]) {
            const id = values[0];
            if (tableData[id]) {
                delete tableData[id];
                return { rows: [], rowCount: 1 };
            }
        }
        // Handle DELETE FROM table (no WHERE clause)
        if (!query.includes('where')) {
            const rowCount = Object.keys(tableData).length;
            this.data[tableName] = {};
            return { rows: [], rowCount };
        }
        return { rows: [], rowCount: 0 };
    }
    handleAlterSequence(query, _values) {
        // Extract sequence name from ALTER SEQUENCE query
        const sequenceMatch = query.match(/alter sequence\s+(\w+)/i);
        if (sequenceMatch) {
            const sequenceName = sequenceMatch[1];
            this.sequenceCounters[sequenceName] = 1;
        }
        return { rows: [], rowCount: 0 };
    }
    generateId(_tableName) {
        // Generate a UUID-like ID
        const timestamp = Date.now();
        const random = Math.random().toString(36).substring(2, 15);
        return `${timestamp}-${random}`;
    }
    // Test utilities
    getData() {
        return { ...this.data };
    }
    clearData() {
        this.initializeSequences();
    }
    setData(tableName, data) {
        this.data[tableName] = { ...data };
    }
    getTableData(tableName) {
        return { ...this.data[tableName] };
    }
}
exports.MockDatabaseService = MockDatabaseService;
// Singleton instance for tests
exports.mockDatabaseService = new MockDatabaseService();
// Export for use in tests
exports.default = exports.mockDatabaseService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUva2ltL3RpdG8vc2VydmVyL3Rlc3RzL3V0aWxzL21vY2tEYXRhYmFzZVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFhSCxNQUFhLG1CQUFtQjtJQUk5QjtRQUhRLFNBQUksR0FBcUIsRUFBRSxDQUFDO1FBQzVCLHFCQUFnQixHQUF1QyxFQUFFLENBQUM7UUFHaEUsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVPLG1CQUFtQjtRQUN6QiwrQkFBK0I7UUFDL0IsSUFBSSxDQUFDLGdCQUFnQixHQUFHO1lBQ3RCLFlBQVksRUFBRSxDQUFDO1lBQ2Ysa0JBQWtCLEVBQUUsQ0FBQztZQUNyQixnQkFBZ0IsRUFBRSxDQUFDO1lBQ25CLHlCQUF5QixFQUFFLENBQUM7WUFDNUIsMEJBQTBCLEVBQUUsQ0FBQztZQUM3QiwrQkFBK0IsRUFBRSxDQUFDO1lBQ2xDLHdCQUF3QixFQUFFLENBQUM7WUFDM0IsYUFBYSxFQUFFLENBQUM7WUFDaEIscUJBQXFCLEVBQUUsQ0FBQztZQUN4QixzQkFBc0IsRUFBRSxDQUFDO1lBQ3pCLHNCQUFzQixFQUFFLENBQUM7WUFDekIseUJBQXlCLEVBQUUsQ0FBQztZQUM1QixzQkFBc0IsRUFBRSxDQUFDO1lBQ3pCLHdCQUF3QixFQUFFLENBQUM7WUFDM0Isc0JBQXNCLEVBQUUsQ0FBQztZQUN6QixlQUFlLEVBQUUsQ0FBQztTQUNuQixDQUFDO1FBRUYsd0JBQXdCO1FBQ3hCLElBQUksQ0FBQyxJQUFJLEdBQUc7WUFDVixLQUFLLEVBQUUsRUFBRTtZQUNULFdBQVcsRUFBRSxFQUFFO1lBQ2YsU0FBUyxFQUFFLEVBQUU7WUFDYixrQkFBa0IsRUFBRSxFQUFFO1lBQ3RCLG1CQUFtQixFQUFFLEVBQUU7WUFDdkIsd0JBQXdCLEVBQUUsRUFBRTtZQUM1QixpQkFBaUIsRUFBRSxFQUFFO1lBQ3JCLE1BQU0sRUFBRSxFQUFFO1lBQ1YsY0FBYyxFQUFFLEVBQUU7WUFDbEIsZUFBZSxFQUFFLEVBQUU7WUFDbkIs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SUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRCxTQUFTO1FBQ1AsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVELE9BQU8sQ0FBQyxTQUFpQixFQUFFLElBQVM7UUFDbEMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLEdBQUcsSUFBSSxFQUFFLENBQUM7SUFDckMsQ0FBQztJQUVELFlBQVksQ0FBQyxTQUFpQjtRQUM1QixPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUM7SUFDckMsQ0FBQztDQUNGO0FBNVVELGtEQTRVQztBQUVELCtCQUErQjtBQUNsQixRQUFBLG1CQUFtQixHQUFHLElBQUksbUJBQW1CLEVBQUUsQ0FBQztBQUU3RCwwQkFBMEI7QUFDMUIsa0JBQWUsMkJBQW1CLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUva2ltL3RpdG8vc2VydmVyL3Rlc3RzL3V0aWxzL21vY2tEYXRhYmFzZVNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNb2NrIERhdGFiYXNlIFNlcnZpY2UgZm9yIFRlc3RpbmdcbiAqIFxuICogVGhpcyBtb2NrIHNlcnZpY2UgcHJvdmlkZXMgdGhlIHNhbWUgaW50ZXJmYWNlIGFzIHRoZSByZWFsIGRhdGFiYXNlIHNlcnZpY2VcbiAqIGJ1dCBzdG9yZXMgZGF0YSBpbiBtZW1vcnkgaW5zdGVhZCBvZiBjb25uZWN0aW5nIHRvIFBvc3RncmVTUUwuXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBNb2NrUXVlcnlSZXN1bHQge1xuICByb3dzOiBhbnlbXTtcbiAgcm93Q291bnQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb2NrRGF0YWJhc2VEYXRhIHtcbiAgW3RhYmxlTmFtZTogc3RyaW5nXToge1xuICAgIFtpZDogc3RyaW5nXTogYW55O1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgTW9ja0RhdGFiYXNlU2VydmljZSB7XG4gIHByaXZhdGUgZGF0YTogTW9ja0RhdGFiYXNlRGF0YSA9IHt9O1xuICBwcml2YXRlIHNlcXVlbmNlQ291bnRlcnM6IHsgW3NlcXVlbmNlTmFtZTogc3RyaW5nXTogbnVtYmVyIH0gPSB7fTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmluaXRpYWxpemVTZXF1ZW5jZXMoKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVNlcXVlbmNlcygpOiB2b2lkIHtcbiAgICAvLyBJbml0aWFsaXplIHNlcXVlbmNlIGNvdW50ZXJzXG4gICAgdGhpcy5zZXF1ZW5jZUNvdW50ZXJzID0ge1xuICAgICAgdXNlcnNfaWRfc2VxOiAxLFxuICAgICAgZGVwYXJ0bWVudHNfaWRfc2VxOiAxLFxuICAgICAgZW1wbG95ZWVzX2lkX3NlcTogMSxcbiAgICAgIGF0dGVuZGFuY2VfcmVjb3Jkc19pZF9zZXE6IDEsXG4gICAgICBhdHRlbmRhbmNlX3Nlc3Npb25zX2lkX3NlcTogMSxcbiAgICAgIHRpbWVfY29ycmVjdGlvbl9yZXF1ZXN0c19pZF9zZXE6IDEsXG4gICAgICBvdmVydGltZV9yZXF1ZXN0c19pZF9zZXE6IDEsXG4gICAgICBsZWF2ZXNfaWRfc2VxOiAxLFxuICAgICAgbGVhdmVfYmFsYW5jZXNfaWRfc2VxOiAxLFxuICAgICAgcGF5cm9sbF9wZXJpb2RzX2lkX3NlcTogMSxcbiAgICAgIHBheXJvbGxfcmVjb3Jkc19pZF9zZXE6IDEsXG4gICAgICBwYXlyb2xsX2RlZHVjdGlvbnNfaWRfc2VxOiAxLFxuICAgICAgZGVkdWN0aW9uX3R5cGVzX2lkX3NlcTogMSxcbiAgICAgIHBheXJvbGxfYXBwcm92YWxzX2lkX3NlcTogMSxcbiAgICAgIHN5c3RlbV9zZXR0aW5nc19pZF9zZXE6IDEsXG4gICAgICBpZF9jYXJkc19pZF9zZXE6IDFcbiAgICB9O1xuXG4gICAgLy8gSW5pdGlhbGl6ZSB0YWJsZSBkYXRhXG4gICAgdGhpcy5kYXRhID0ge1xuICAgICAgdXNlcnM6IHt9LFxuICAgICAgZGVwYXJ0bWVudHM6IHt9LFxuICAgICAgZW1wbG95ZWVzOiB7fSxcbiAgICAgIGF0dGVuZGFuY2VfcmVjb3Jkczoge30sXG4gICAgICBhdHRlbmRhbmNlX3Nlc3Npb25zOiB7fSxcbiAgICAgIHRpbWVfY29ycmVjdGlvbl9yZXF1ZXN0czoge30sXG4gICAgICBvdmVydGltZV9yZXF1ZXN0czoge30sXG4gICAgICBsZWF2ZXM6IHt9LFxuICAgICAgbGVhdmVfYmFsYW5jZXM6IHt9LFxuICAgICAgcGF5cm9sbF9wZXJpb2RzOiB7fSxcbiAgICAgIHBheXJvbGxfcmVjb3Jkczoge30sXG4gICAgICBwYXlyb2xsX2RlZHVjdGlvbnM6IHt9LFxuICAgICAgZGVkdWN0aW9uX3R5cGVzOiB7fSxcbiAgICAgIHBheXJvbGxfYXBwcm92YWxzOiB7fSxcbiAgICAgIHN5c3RlbV9zZXR0aW5nczoge30sXG4gICAgICBpZF9jYXJkczoge31cbiAgICB9O1xuICB9XG5cbiAgLy8gRXZlbnQgZW1pdHRlciBtZXRob2RzXG4gIG9uKF9ldmVudDogc3RyaW5nLCBfY2FsbGJhY2s6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHZvaWQge1xuICAgIC8vIE1vY2sgZXZlbnQgZW1pdHRlciAtIGRvIG5vdGhpbmcgZm9yIHRlc3RzXG4gIH1cblxuICAvLyBDb25uZWN0aW9uIG1ldGhvZHNcbiAgYXN5bmMgY29ubmVjdCgpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB7XG4gICAgICBxdWVyeTogdGhpcy5xdWVyeS5iaW5kKHRoaXMpLFxuICAgICAgcmVsZWFzZTogKCkgPT4ge31cbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgcXVlcnkocXVlcnk6IHN0cmluZywgdmFsdWVzOiBhbnlbXSA9IFtdKTogUHJvbWlzZTxNb2NrUXVlcnlSZXN1bHQ+IHtcbiAgICBjb25zdCBub3JtYWxpemVkUXVlcnkgPSBxdWVyeS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICAvLyBIYW5kbGUgSU5TRVJUIHF1ZXJpZXNcbiAgICBpZiAobm9ybWFsaXplZFF1ZXJ5LnN0YXJ0c1dpdGgoJ2luc2VydCBpbnRvJykpIHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZUluc2VydChxdWVyeSwgdmFsdWVzKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIFNFTEVDVCBxdWVyaWVzXG4gICAgaWYgKG5vcm1hbGl6ZWRRdWVyeS5zdGFydHNXaXRoKCdzZWxlY3QnKSkge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlU2VsZWN0KHF1ZXJ5LCB2YWx1ZXMpO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgVVBEQVRFIHF1ZXJpZXNcbiAgICBpZiAobm9ybWFsaXplZFF1ZXJ5LnN0YXJ0c1dpdGgoJ3VwZGF0ZScpKSB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVVcGRhdGUocXVlcnksIHZhbHVlcyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBERUxFVEUgcXVlcmllc1xuICAgIGlmIChub3JtYWxpemVkUXVlcnkuc3RhcnRzV2l0aCgnZGVsZXRlJykpIHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZURlbGV0ZShxdWVyeSwgdmFsdWVzKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIEFMVEVSIFNFUVVFTkNFIHF1ZXJpZXNcbiAgICBpZiAobm9ybWFsaXplZFF1ZXJ5LnN0YXJ0c1dpdGgoJ2FsdGVyIHNlcXVlbmNlJykpIHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZUFsdGVyU2VxdWVuY2UocXVlcnksIHZhbHVlcyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBTRVQgcXVlcmllc1xuICAgIGlmIChub3JtYWxpemVkUXVlcnkuc3RhcnRzV2l0aCgnc2V0JykpIHtcbiAgICAgIHJldHVybiB7IHJvd3M6IFtdLCByb3dDb3VudDogMCB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBEZWZhdWx0IHJlc3BvbnNlIGZvciBvdGhlciBxdWVyaWVzXG4gICAgcmV0dXJuIHsgcm93czogW10sIHJvd0NvdW50OiAwIH07XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUluc2VydChxdWVyeTogc3RyaW5nLCB2YWx1ZXM6IGFueVtdKTogTW9ja1F1ZXJ5UmVzdWx0IHtcbiAgICAvLyBFeHRyYWN0IHRhYmxlIG5hbWUgZnJvbSBJTlNFUlQgcXVlcnlcbiAgICBjb25zdCB0YWJsZU1hdGNoID0gcXVlcnkubWF0Y2goL2luc2VydCBpbnRvXFxzKyhcXHcrKS9pKTtcbiAgICBpZiAoIXRhYmxlTWF0Y2gpIHtcbiAgICAgIHJldHVybiB7IHJvd3M6IFtdLCByb3dDb3VudDogMCB9O1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB0YWJsZU5hbWUgPSB0YWJsZU1hdGNoWzFdO1xuICAgIFxuICAgIC8vIEdlbmVyYXRlIElEIGlmIG5vdCBwcm92aWRlZFxuICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlkKHRhYmxlTmFtZSk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIHJvdyBkYXRhXG4gICAgY29uc3Qgcm93OiBhbnkgPSB7IGlkIH07XG4gICAgXG4gICAgLy8gTWFwIHZhbHVlcyB0byBjb2x1bW5zIChzaW1wbGlmaWVkIC0gYXNzdW1lcyB2YWx1ZXMgYXJlIGluIG9yZGVyKVxuICAgIGNvbnN0IGNvbHVtbk1hdGNoID0gcXVlcnkubWF0Y2goL2luc2VydCBpbnRvXFxzK1xcdytcXHMqXFwoKFteKV0rKVxcKS9pKTtcbiAgICBpZiAoY29sdW1uTWF0Y2gpIHtcbiAgICAgIGNvbnN0IGNvbHVtbnMgPSBjb2x1bW5NYXRjaFsxXS5zcGxpdCgnLCcpLm1hcChjb2wgPT4gY29sLnRyaW0oKSk7XG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKHZhbHVlc1tpbmRleF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJvd1tjb2x1bW5dID0gdmFsdWVzW2luZGV4XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0b3JlIGluIG1vY2sgZGF0YVxuICAgIHRoaXMuZGF0YVt0YWJsZU5hbWVdW2lkXSA9IHJvdztcbiAgICBcbiAgICAvLyBSZXR1cm4gdGhlIGluc2VydGVkIHJvd1xuICAgIHJldHVybiB7IHJvd3M6IFtyb3ddLCByb3dDb3VudDogMSB9O1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVTZWxlY3QocXVlcnk6IHN0cmluZywgdmFsdWVzOiBhbnlbXSk6IE1vY2tRdWVyeVJlc3VsdCB7XG4gICAgY29uc29sZS5sb2coJ2hhbmRsZVNlbGVjdCBjYWxsZWQgd2l0aCBxdWVyeTonLCBxdWVyeSk7XG4gICAgY29uc29sZS5sb2coJ3F1ZXJ5LmluY2x1ZGVzKFwiY291bnQoKilcIik6JywgcXVlcnkuaW5jbHVkZXMoJ2NvdW50KCopJykpO1xuICAgIFxuICAgIC8vIEhhbmRsZSBDT1VOVCgqKSBxdWVyaWVzXG4gICAgaWYgKHF1ZXJ5LmluY2x1ZGVzKCdjb3VudCgqKScpKSB7XG4gICAgICBjb25zdCB0YWJsZU1hdGNoID0gcXVlcnkubWF0Y2goL2Zyb21cXHMrKFxcdyspL2kpO1xuICAgICAgaWYgKCF0YWJsZU1hdGNoKSB7XG4gICAgICAgIHJldHVybiB7IHJvd3M6IFt7IGNvdW50OiAnMCcgfV0sIHJvd0NvdW50OiAxIH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHRhYmxlTmFtZSA9IHRhYmxlTWF0Y2hbMV07XG4gICAgICBjb25zdCB0YWJsZURhdGEgPSB0aGlzLmRhdGFbdGFibGVOYW1lXSB8fCB7fTtcbiAgICAgIGxldCBjb3VudCA9IE9iamVjdC5rZXlzKHRhYmxlRGF0YSkubGVuZ3RoO1xuICAgICAgXG4gICAgICAvLyBIYW5kbGUgV0hFUkUgY2xhdXNlcyBmb3IgQ09VTlRcbiAgICAgIGlmIChxdWVyeS5pbmNsdWRlcygnd2hlcmUnKSkge1xuICAgICAgICBsZXQgcm93cyA9IE9iamVjdC52YWx1ZXModGFibGVEYXRhKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBXSEVSRSBzdGF0dXMgPSAkMVxuICAgICAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIHN0YXR1cyA9ICQxJykgJiYgdmFsdWVzWzBdKSB7XG4gICAgICAgICAgcm93cyA9IHJvd3MuZmlsdGVyKHJvdyA9PiByb3cuc3RhdHVzID09PSB2YWx1ZXNbMF0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgV0hFUkUgZW1wbG95ZWVfaWQgPSAkMVxuICAgICAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIGVtcGxveWVlX2lkID0gJDEnKSAmJiB2YWx1ZXNbMF0pIHtcbiAgICAgICAgICByb3dzID0gcm93cy5maWx0ZXIocm93ID0+IHJvdy5lbXBsb3llZV9pZCA9PT0gdmFsdWVzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY291bnQgPSByb3dzLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHsgcm93czogW3sgY291bnQ6IGNvdW50LnRvU3RyaW5nKCkgfV0sIHJvd0NvdW50OiAxIH07XG4gICAgfVxuICAgIFxuICAgIC8vIEV4dHJhY3QgdGFibGUgbmFtZSBmcm9tIFNFTEVDVCBxdWVyeVxuICAgIGNvbnN0IHRhYmxlTWF0Y2ggPSBxdWVyeS5tYXRjaCgvZnJvbVxccysoXFx3KykvaSk7XG4gICAgaWYgKCF0YWJsZU1hdGNoKSB7XG4gICAgICByZXR1cm4geyByb3dzOiBbXSwgcm93Q291bnQ6IDAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdGFibGVOYW1lID0gdGFibGVNYXRjaFsxXTtcbiAgICBjb25zdCB0YWJsZURhdGEgPSB0aGlzLmRhdGFbdGFibGVOYW1lXSB8fCB7fTtcbiAgICBcbiAgICAvLyBTaW1wbGUgV0hFUkUgY2xhdXNlIGhhbmRsaW5nXG4gICAgbGV0IHJvd3MgPSBPYmplY3QudmFsdWVzKHRhYmxlRGF0YSk7XG4gICAgXG4gICAgLy8gSGFuZGxlIFdIRVJFIGlkID0gJDFcbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIGlkID0gJDEnKSAmJiB2YWx1ZXNbMF0pIHtcbiAgICAgIHJvd3MgPSByb3dzLmZpbHRlcihyb3cgPT4gcm93LmlkID09PSB2YWx1ZXNbMF0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgV0hFUkUgZW1haWwgPSAkMVxuICAgIGlmIChxdWVyeS5pbmNsdWRlcygnd2hlcmUgZW1haWwgPSAkMScpICYmIHZhbHVlc1swXSkge1xuICAgICAgcm93cyA9IHJvd3MuZmlsdGVyKHJvdyA9PiByb3cuZW1haWwgPT09IHZhbHVlc1swXSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBXSEVSRSBzdGF0dXMgPSAkMVxuICAgIGlmIChxdWVyeS5pbmNsdWRlcygnd2hlcmUgc3RhdHVzID0gJDEnKSAmJiB2YWx1ZXNbMF0pIHtcbiAgICAgIHJvd3MgPSByb3dzLmZpbHRlcihyb3cgPT4gcm93LnN0YXR1cyA9PT0gdmFsdWVzWzBdKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIFdIRVJFIGVtcGxveWVlX2lkID0gJDFcbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIGVtcGxveWVlX2lkID0gJDEnKSAmJiB2YWx1ZXNbMF0pIHtcbiAgICAgIHJvd3MgPSByb3dzLmZpbHRlcihyb3cgPT4gcm93LmVtcGxveWVlX2lkID09PSB2YWx1ZXNbMF0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgV0hFUkUgYXR0ZW5kYW5jZV9yZWNvcmRfaWQgPSAkMVxuICAgIGlmIChxdWVyeS5pbmNsdWRlcygnd2hlcmUgYXR0ZW5kYW5jZV9yZWNvcmRfaWQgPSAkMScpICYmIHZhbHVlc1swXSkge1xuICAgICAgcm93cyA9IHJvd3MuZmlsdGVyKHJvdyA9PiByb3cuYXR0ZW5kYW5jZV9yZWNvcmRfaWQgPT09IHZhbHVlc1swXSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBXSEVSRSBkYXRlID0gJDFcbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIGRhdGUgPSAkMScpICYmIHZhbHVlc1swXSkge1xuICAgICAgcm93cyA9IHJvd3MuZmlsdGVyKHJvdyA9PiByb3cuZGF0ZSA9PT0gdmFsdWVzWzBdKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIE9SREVSIEJZXG4gICAgaWYgKHF1ZXJ5LmluY2x1ZGVzKCdvcmRlciBieScpKSB7XG4gICAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ29yZGVyIGJ5IGZpcnN0X25hbWUsIGxhc3RfbmFtZScpKSB7XG4gICAgICAgIHJvd3Muc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgIGNvbnN0IG5hbWVBID0gYCR7YS5maXJzdF9uYW1lIHx8ICcnfSAke2EubGFzdF9uYW1lIHx8ICcnfWAudHJpbSgpO1xuICAgICAgICAgIGNvbnN0IG5hbWVCID0gYCR7Yi5maXJzdF9uYW1lIHx8ICcnfSAke2IubGFzdF9uYW1lIHx8ICcnfWAudHJpbSgpO1xuICAgICAgICAgIHJldHVybiBuYW1lQS5sb2NhbGVDb21wYXJlKG5hbWVCKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBMSU1JVFxuICAgIGlmIChxdWVyeS5pbmNsdWRlcygnbGltaXQnKSkge1xuICAgICAgY29uc3QgbGltaXRNYXRjaCA9IHF1ZXJ5Lm1hdGNoKC9saW1pdFxccysoXFxkKykvaSk7XG4gICAgICBpZiAobGltaXRNYXRjaCkge1xuICAgICAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KGxpbWl0TWF0Y2hbMV0pO1xuICAgICAgICByb3dzID0gcm93cy5zbGljZSgwLCBsaW1pdCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IHJvd3MsIHJvd0NvdW50OiByb3dzLmxlbmd0aCB9O1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVVcGRhdGUocXVlcnk6IHN0cmluZywgdmFsdWVzOiBhbnlbXSk6IE1vY2tRdWVyeVJlc3VsdCB7XG4gICAgLy8gRXh0cmFjdCB0YWJsZSBuYW1lIGZyb20gVVBEQVRFIHF1ZXJ5XG4gICAgY29uc3QgdGFibGVNYXRjaCA9IHF1ZXJ5Lm1hdGNoKC91cGRhdGVcXHMrKFxcdyspL2kpO1xuICAgIGlmICghdGFibGVNYXRjaCkge1xuICAgICAgcmV0dXJuIHsgcm93czogW10sIHJvd0NvdW50OiAwIH07XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHRhYmxlTWF0Y2hbMV07XG4gICAgY29uc3QgdGFibGVEYXRhID0gdGhpcy5kYXRhW3RhYmxlTmFtZV0gfHwge307XG4gICAgXG4gICAgLy8gSGFuZGxlIFdIRVJFIGlkID0gJDFcbiAgICBpZiAocXVlcnkuaW5jbHVkZXMoJ3doZXJlIGlkID0gJDEnKSAmJiB2YWx1ZXNbMF0pIHtcbiAgICAgIGNvbnN0IGlkID0gdmFsdWVzWzBdO1xuICAgICAgaWYgKHRhYmxlRGF0YVtpZF0pIHtcbiAgICAgICAgLy8gVXBkYXRlIHRoZSByb3cgKHNpbXBsaWZpZWQgLSBhc3N1bWVzIFNFVCBjbGF1c2UgaXMgYXQgdGhlIGVuZClcbiAgICAgICAgY29uc3Qgc2V0TWF0Y2ggPSBxdWVyeS5tYXRjaCgvc2V0XFxzKyguKz8pXFxzK3doZXJlL2kpO1xuICAgICAgICBpZiAoc2V0TWF0Y2gpIHtcbiAgICAgICAgICBjb25zdCBzZXRDbGF1c2UgPSBzZXRNYXRjaFsxXTtcbiAgICAgICAgICBjb25zdCB1cGRhdGVzID0gc2V0Q2xhdXNlLnNwbGl0KCcsJykubWFwKHVwZGF0ZSA9PiB1cGRhdGUudHJpbSgpKTtcbiAgICAgICAgICB1cGRhdGVzLmZvckVhY2godXBkYXRlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IFtjb2x1bW4sIHZhbHVlXSA9IHVwZGF0ZS5zcGxpdCgnPScpLm1hcChwYXJ0ID0+IHBhcnQudHJpbSgpKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5zdGFydHNXaXRoKCckJykpIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFyYW1JbmRleCA9IHBhcnNlSW50KHZhbHVlLnN1YnN0cmluZygxKSkgLSAxO1xuICAgICAgICAgICAgICBpZiAodmFsdWVzW3BhcmFtSW5kZXhdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0YWJsZURhdGFbaWRdW2NvbHVtbl0gPSB2YWx1ZXNbcGFyYW1JbmRleF07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyByb3dzOiBbdGFibGVEYXRhW2lkXV0sIHJvd0NvdW50OiAxIH07XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IHJvd3M6IFtdLCByb3dDb3VudDogMCB9O1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVEZWxldGUocXVlcnk6IHN0cmluZywgdmFsdWVzOiBhbnlbXSk6IE1vY2tRdWVyeVJlc3VsdCB7XG4gICAgLy8gRXh0cmFjdCB0YWJsZSBuYW1lIGZyb20gREVMRVRFIHF1ZXJ5XG4gICAgY29uc3QgdGFibGVNYXRjaCA9IHF1ZXJ5Lm1hdGNoKC9kZWxldGUgZnJvbVxccysoXFx3KykvaSk7XG4gICAgaWYgKCF0YWJsZU1hdGNoKSB7XG4gICAgICByZXR1cm4geyByb3dzOiBbXSwgcm93Q291bnQ6IDAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdGFibGVOYW1lID0gdGFibGVNYXRjaFsxXTtcbiAgICBjb25zdCB0YWJsZURhdGEgPSB0aGlzLmRhdGFbdGFibGVOYW1lXSB8fCB7fTtcbiAgICBcbiAgICAvLyBIYW5kbGUgV0hFUkUgaWQgPSAkMVxuICAgIGlmIChxdWVyeS5pbmNsdWRlcygnd2hlcmUgaWQgPSAkMScpICYmIHZhbHVlc1swXSkge1xuICAgICAgY29uc3QgaWQgPSB2YWx1ZXNbMF07XG4gICAgICBpZiAodGFibGVEYXRhW2lkXSkge1xuICAgICAgICBkZWxldGUgdGFibGVEYXRhW2lkXTtcbiAgICAgICAgcmV0dXJuIHsgcm93czogW10sIHJvd0NvdW50OiAxIH07XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBERUxFVEUgRlJPTSB0YWJsZSAobm8gV0hFUkUgY2xhdXNlKVxuICAgIGlmICghcXVlcnkuaW5jbHVkZXMoJ3doZXJlJykpIHtcbiAgICAgIGNvbnN0IHJvd0NvdW50ID0gT2JqZWN0LmtleXModGFibGVEYXRhKS5sZW5ndGg7XG4gICAgICB0aGlzLmRhdGFbdGFibGVOYW1lXSA9IHt9O1xuICAgICAgcmV0dXJuIHsgcm93czogW10sIHJvd0NvdW50IH07XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IHJvd3M6IFtdLCByb3dDb3VudDogMCB9O1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVBbHRlclNlcXVlbmNlKHF1ZXJ5OiBzdHJpbmcsIF92YWx1ZXM6IGFueVtdKTogTW9ja1F1ZXJ5UmVzdWx0IHtcbiAgICAvLyBFeHRyYWN0IHNlcXVlbmNlIG5hbWUgZnJvbSBBTFRFUiBTRVFVRU5DRSBxdWVyeVxuICAgIGNvbnN0IHNlcXVlbmNlTWF0Y2ggPSBxdWVyeS5tYXRjaCgvYWx0ZXIgc2VxdWVuY2VcXHMrKFxcdyspL2kpO1xuICAgIGlmIChzZXF1ZW5jZU1hdGNoKSB7XG4gICAgICBjb25zdCBzZXF1ZW5jZU5hbWUgPSBzZXF1ZW5jZU1hdGNoWzFdO1xuICAgICAgdGhpcy5zZXF1ZW5jZUNvdW50ZXJzW3NlcXVlbmNlTmFtZV0gPSAxO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyByb3dzOiBbXSwgcm93Q291bnQ6IDAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVJZChfdGFibGVOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIEdlbmVyYXRlIGEgVVVJRC1saWtlIElEXG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCByYW5kb20gPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgMTUpO1xuICAgIHJldHVybiBgJHt0aW1lc3RhbXB9LSR7cmFuZG9tfWA7XG4gIH1cblxuICAvLyBUZXN0IHV0aWxpdGllc1xuICBnZXREYXRhKCk6IE1vY2tEYXRhYmFzZURhdGEge1xuICAgIHJldHVybiB7IC4uLnRoaXMuZGF0YSB9O1xuICB9XG5cbiAgY2xlYXJEYXRhKCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdGlhbGl6ZVNlcXVlbmNlcygpO1xuICB9XG5cbiAgc2V0RGF0YSh0YWJsZU5hbWU6IHN0cmluZywgZGF0YTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5kYXRhW3RhYmxlTmFtZV0gPSB7IC4uLmRhdGEgfTtcbiAgfVxuXG4gIGdldFRhYmxlRGF0YSh0YWJsZU5hbWU6IHN0cmluZyk6IGFueSB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5kYXRhW3RhYmxlTmFtZV0gfTtcbiAgfVxufVxuXG4vLyBTaW5nbGV0b24gaW5zdGFuY2UgZm9yIHRlc3RzXG5leHBvcnQgY29uc3QgbW9ja0RhdGFiYXNlU2VydmljZSA9IG5ldyBNb2NrRGF0YWJhc2VTZXJ2aWNlKCk7XG5cbi8vIEV4cG9ydCBmb3IgdXNlIGluIHRlc3RzXG5leHBvcnQgZGVmYXVsdCBtb2NrRGF0YWJhc2VTZXJ2aWNlO1xuIl0sInZlcnNpb24iOjN9