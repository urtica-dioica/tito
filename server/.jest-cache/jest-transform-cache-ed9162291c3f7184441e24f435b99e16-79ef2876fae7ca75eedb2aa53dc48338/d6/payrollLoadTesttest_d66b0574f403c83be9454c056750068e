a3e0a8f2f29ebc6af5a53fee83b39074
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const loadTestUtils_1 = require("./loadTestUtils");
const axios = {
    create: () => ({
        get: jest.fn(),
        post: jest.fn(),
        put: jest.fn(),
        delete: jest.fn(),
        patch: jest.fn(),
        interceptors: {
            request: { use: jest.fn() },
            response: { use: jest.fn() }
        }
    })
};
describe('Payroll Load Tests', () => {
    let loadTestRunner;
    let baseURL;
    let authToken;
    beforeAll(async () => {
        baseURL = process.env.TEST_BASE_URL || 'http://localhost:3000';
        const config = {
            baseURL,
            concurrentUsers: 5,
            requestsPerUser: 3,
            rampUpTime: 1000, // 1 second
            testDuration: 20000, // 20 seconds
            timeout: 15000 // 15 seconds
        };
        loadTestRunner = new loadTestUtils_1.LoadTestRunner(config);
        // Get authentication token for HR user
        try {
            const response = await axios.create().post(`${baseURL}/api/v1/auth/login`, {
                email: 'hr@example.com',
                password: 'password123'
            });
            authToken = response.data.data.accessToken;
        }
        catch (error) {
            console.warn('Could not obtain HR auth token for payroll load test');
            authToken = 'test-hr-token';
        }
    });
    describe('Payroll Periods Load Test', () => {
        it('should handle concurrent requests to get payroll periods', async () => {
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/periods', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    params: {
                        page: 1,
                        limit: 10
                    }
                });
            };
            const result = await loadTestRunner.runLoadTest(requestFunction, 'Get Payroll Periods Load Test');
            // Performance assertions
            expect(result.averageResponseTime).toBeLessThan(2000); // Less than 2 seconds
            expect(result.errorRate).toBeLessThan(0.1); // Less than 10% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(2); // At least 2 RPS
            console.log(loadTestRunner.generateReport(result, 'Get Payroll Periods Load Test'));
        }, 60000);
    });
    describe('Payroll Records Load Test', () => {
        it('should handle concurrent requests to get payroll records', async () => {
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/periods/test-period-id/records', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    params: {
                        page: 1,
                        limit: 20
                    }
                });
            };
            const result = await loadTestRunner.runLoadTest(requestFunction, 'Get Payroll Records Load Test');
            // Performance assertions
            expect(result.averageResponseTime).toBeLessThan(3000); // Less than 3 seconds
            expect(result.errorRate).toBeLessThan(0.15); // Less than 15% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(1); // At least 1 RPS
            console.log(loadTestRunner.generateReport(result, 'Get Payroll Records Load Test'));
        }, 60000);
    });
    describe('Payroll Summary Load Test', () => {
        it('should handle concurrent requests to get payroll summary', async () => {
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/periods/test-period-id/summary', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
            };
            const result = await loadTestRunner.runLoadTest(requestFunction, 'Get Payroll Summary Load Test');
            // Performance assertions
            expect(result.averageResponseTime).toBeLessThan(2500); // Less than 2.5 seconds
            expect(result.errorRate).toBeLessThan(0.1); // Less than 10% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(2); // At least 2 RPS
            console.log(loadTestRunner.generateReport(result, 'Get Payroll Summary Load Test'));
        }, 60000);
    });
    describe('Payroll Generation Load Test', () => {
        it('should handle concurrent payroll generation requests', async () => {
            const requestFunction = async (axios) => {
                return axios.create().post('/api/v1/payroll/periods/test-period-id/generate', {}, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
            };
            const result = await loadTestRunner.runLoadTest(requestFunction, 'Payroll Generation Load Test');
            // Performance assertions (more lenient for generation)
            expect(result.averageResponseTime).toBeLessThan(10000); // Less than 10 seconds
            expect(result.errorRate).toBeLessThan(0.2); // Less than 20% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(0.5); // At least 0.5 RPS
            console.log(loadTestRunner.generateReport(result, 'Payroll Generation Load Test'));
        }, 90000);
    });
    describe('Payroll Stats Load Test', () => {
        it('should handle concurrent requests to get payroll statistics', async () => {
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/stats', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    params: {
                        period: '2024-01'
                    }
                });
            };
            const result = await loadTestRunner.runLoadTest(requestFunction, 'Get Payroll Stats Load Test');
            // Performance assertions
            expect(result.averageResponseTime).toBeLessThan(3000); // Less than 3 seconds
            expect(result.errorRate).toBeLessThan(0.1); // Less than 10% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(1); // At least 1 RPS
            console.log(loadTestRunner.generateReport(result, 'Get Payroll Stats Load Test'));
        }, 60000);
    });
    describe('High Load Payroll Test', () => {
        it('should handle high concurrent load on payroll endpoints', async () => {
            const highLoadConfig = {
                baseURL,
                concurrentUsers: 20,
                requestsPerUser: 5,
                rampUpTime: 3000, // 3 seconds
                testDuration: 45000, // 45 seconds
                timeout: 20000 // 20 seconds
            };
            const highLoadRunner = new loadTestUtils_1.LoadTestRunner(highLoadConfig);
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/periods', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    params: {
                        page: 1,
                        limit: 10
                    }
                });
            };
            const result = await highLoadRunner.runLoadTest(requestFunction, 'High Load Payroll Test');
            // High load performance assertions
            expect(result.averageResponseTime).toBeLessThan(4000); // Less than 4 seconds
            expect(result.errorRate).toBeLessThan(0.15); // Less than 15% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(5); // At least 5 RPS
            expect(result.totalRequests).toBe(100); // 20 users * 5 requests each
            console.log(highLoadRunner.generateReport(result, 'High Load Payroll Test'));
        }, 90000);
    });
    describe('Payroll Endpoint Comparison', () => {
        it('should compare performance across different payroll endpoints', async () => {
            const endpoints = [
                {
                    name: 'Get Periods',
                    request: (axios) => axios.create().get('/api/v1/payroll/periods', {
                        headers: { 'Authorization': `Bearer ${authToken}` },
                        params: { page: 1, limit: 10 }
                    })
                },
                {
                    name: 'Get Records',
                    request: (axios) => axios.create().get('/api/v1/payroll/periods/test-period-id/records', {
                        headers: { 'Authorization': `Bearer ${authToken}` },
                        params: { page: 1, limit: 20 }
                    })
                },
                {
                    name: 'Get Summary',
                    request: (axios) => axios.create().get('/api/v1/payroll/periods/test-period-id/summary', {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    })
                },
                {
                    name: 'Get Stats',
                    request: (axios) => axios.create().get('/api/v1/payroll/stats', {
                        headers: { 'Authorization': `Bearer ${authToken}` },
                        params: { period: '2024-01' }
                    })
                }
            ];
            const results = {};
            for (const endpoint of endpoints) {
                const result = await loadTestRunner.runLoadTest(endpoint.request, `${endpoint.name} Performance`);
                results[endpoint.name] = result;
            }
            // Compare results
            console.log('\nðŸ“Š PAYROLL ENDPOINT COMPARISON');
            console.log('==============================');
            for (const [name, result] of Object.entries(results)) {
                console.log(`\n${name}:`);
                console.log(`  Average Response Time: ${result.averageResponseTime.toFixed(2)}ms`);
                console.log(`  Error Rate: ${(result.errorRate * 100).toFixed(2)}%`);
                console.log(`  Requests/Second: ${result.requestsPerSecond.toFixed(2)}`);
            }
            // Assertions for endpoint comparison
            expect(results['Get Periods'].averageResponseTime).toBeLessThan(2000);
            expect(results['Get Records'].averageResponseTime).toBeLessThan(3000);
            expect(results['Get Summary'].averageResponseTime).toBeLessThan(2500);
            expect(results['Get Stats'].averageResponseTime).toBeLessThan(3000);
        }, 120000);
    });
    describe('Payroll Stress Test', () => {
        it('should handle stress conditions on payroll endpoints', async () => {
            const stressConfig = {
                baseURL,
                concurrentUsers: 30,
                requestsPerUser: 10,
                rampUpTime: 5000, // 5 seconds
                testDuration: 90000, // 90 seconds
                timeout: 30000 // 30 seconds
            };
            const stressRunner = new loadTestUtils_1.LoadTestRunner(stressConfig);
            const requestFunction = async (axios) => {
                return axios.create().get('/api/v1/payroll/periods', {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    params: {
                        page: 1,
                        limit: 10
                    }
                });
            };
            const result = await stressRunner.runLoadTest(requestFunction, 'Payroll Stress Test');
            // Stress test performance assertions (more lenient)
            expect(result.averageResponseTime).toBeLessThan(6000); // Less than 6 seconds
            expect(result.errorRate).toBeLessThan(0.25); // Less than 25% error rate
            expect(result.requestsPerSecond).toBeGreaterThan(3); // At least 3 RPS
            expect(result.totalRequests).toBe(300); // 30 users * 10 requests each
            console.log(stressRunner.generateReport(result, 'Payroll Stress Test'));
        }, 150000);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUva2ltL3RpdG8vc2VydmVyL3Rlc3RzL3BlcmZvcm1hbmNlL3BheXJvbGxMb2FkVGVzdC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsbURBQWlGO0FBT2pGLE1BQU0sS0FBSyxHQUFHO0lBQ1osTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDYixHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNkLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNqQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixZQUFZLEVBQUU7WUFDWixPQUFPLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFO1lBQzNCLFFBQVEsRUFBRSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUU7U0FDN0I7S0FDRixDQUFDO0NBQ0gsQ0FBQztBQUVGLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsSUFBSSxjQUE4QixDQUFDO0lBQ25DLElBQUksT0FBZSxDQUFDO0lBQ3BCLElBQUksU0FBaUIsQ0FBQztJQUV0QixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsT0FBTyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxJQUFJLHVCQUF1QixDQUFDO1FBRS9ELE1BQU0sTUFBTSxHQUFtQjtZQUM3QixPQUFPO1lBQ1AsZUFBZSxFQUFFLENBQUM7WUFDbEIsZUFBZSxFQUFFLENBQUM7WUFDbEIsVUFBVSxFQUFFLElBQUksRUFBRSxXQUFXO1lBQzdCLFlBQVksRUFBRSxLQUFLLEVBQUUsYUFBYTtZQUNsQyxPQUFPLEVBQUUsS0FBSyxDQUFDLGFBQWE7U0FDN0IsQ0FBQztRQUVGLGNBQWMsR0FBRyxJQUFJLDhCQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7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cUJBQXFCLENBQ3RCLENBQUM7WUFFRixvREFBb0Q7WUFDcEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLHNCQUFzQjtZQUM3RSxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLDJCQUEyQjtZQUN4RSxNQUFNLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsaUJBQWlCO1lBQ3RFLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsOEJBQThCO1lBRXRFLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUscUJBQXFCLENBQUMsQ0FBQyxDQUFDO1FBQzFFLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNiLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUva2ltL3RpdG8vc2VydmVyL3Rlc3RzL3BlcmZvcm1hbmNlL3BheXJvbGxMb2FkVGVzdC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvYWRUZXN0UnVubmVyLCBMb2FkVGVzdENvbmZpZywgTG9hZFRlc3RSZXN1bHQgfSBmcm9tICcuL2xvYWRUZXN0VXRpbHMnO1xuLy8gTW9jayBheGlvcyBmb3IgdGVzdGluZ1xuaW50ZXJmYWNlIEF4aW9zUmVzcG9uc2Uge1xuICBzdGF0dXM6IG51bWJlcjtcbiAgZGF0YTogYW55O1xufVxuXG5jb25zdCBheGlvcyA9IHtcbiAgY3JlYXRlOiAoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICAgIHBvc3Q6IGplc3QuZm4oKSxcbiAgICBwdXQ6IGplc3QuZm4oKSxcbiAgICBkZWxldGU6IGplc3QuZm4oKSxcbiAgICBwYXRjaDogamVzdC5mbigpLFxuICAgIGludGVyY2VwdG9yczoge1xuICAgICAgcmVxdWVzdDogeyB1c2U6IGplc3QuZm4oKSB9LFxuICAgICAgcmVzcG9uc2U6IHsgdXNlOiBqZXN0LmZuKCkgfVxuICAgIH1cbiAgfSlcbn07XG5cbmRlc2NyaWJlKCdQYXlyb2xsIExvYWQgVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBsb2FkVGVzdFJ1bm5lcjogTG9hZFRlc3RSdW5uZXI7XG4gIGxldCBiYXNlVVJMOiBzdHJpbmc7XG4gIGxldCBhdXRoVG9rZW46IHN0cmluZztcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGJhc2VVUkwgPSBwcm9jZXNzLmVudi5URVNUX0JBU0VfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICAgIFxuICAgIGNvbnN0IGNvbmZpZzogTG9hZFRlc3RDb25maWcgPSB7XG4gICAgICBiYXNlVVJMLFxuICAgICAgY29uY3VycmVudFVzZXJzOiA1LFxuICAgICAgcmVxdWVzdHNQZXJVc2VyOiAzLFxuICAgICAgcmFtcFVwVGltZTogMTAwMCwgLy8gMSBzZWNvbmRcbiAgICAgIHRlc3REdXJhdGlvbjogMjAwMDAsIC8vIDIwIHNlY29uZHNcbiAgICAgIHRpbWVvdXQ6IDE1MDAwIC8vIDE1IHNlY29uZHNcbiAgICB9O1xuICAgIFxuICAgIGxvYWRUZXN0UnVubmVyID0gbmV3IExvYWRUZXN0UnVubmVyKGNvbmZpZyk7XG5cbiAgICAvLyBHZXQgYXV0aGVudGljYXRpb24gdG9rZW4gZm9yIEhSIHVzZXJcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5jcmVhdGUoKS5wb3N0KGAke2Jhc2VVUkx9L2FwaS92MS9hdXRoL2xvZ2luYCwge1xuICAgICAgICBlbWFpbDogJ2hyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMydcbiAgICAgIH0pO1xuICAgICAgYXV0aFRva2VuID0gcmVzcG9uc2UuZGF0YS5kYXRhLmFjY2Vzc1Rva2VuO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBvYnRhaW4gSFIgYXV0aCB0b2tlbiBmb3IgcGF5cm9sbCBsb2FkIHRlc3QnKTtcbiAgICAgIGF1dGhUb2tlbiA9ICd0ZXN0LWhyLXRva2VuJztcbiAgICB9XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXlyb2xsIFBlcmlvZHMgTG9hZCBUZXN0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgdG8gZ2V0IHBheXJvbGwgcGVyaW9kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RGdW5jdGlvbiA9IGFzeW5jIChheGlvczogYW55KTogUHJvbWlzZTxBeGlvc1Jlc3BvbnNlPiA9PiB7XG4gICAgICAgIHJldHVybiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9wZXJpb2RzJywge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2F1dGhUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgICBsaW1pdDogMTBcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0OiBMb2FkVGVzdFJlc3VsdCA9IGF3YWl0IGxvYWRUZXN0UnVubmVyLnJ1bkxvYWRUZXN0KFxuICAgICAgICByZXF1ZXN0RnVuY3Rpb24sXG4gICAgICAgICdHZXQgUGF5cm9sbCBQZXJpb2RzIExvYWQgVGVzdCdcbiAgICAgICk7XG5cbiAgICAgIC8vIFBlcmZvcm1hbmNlIGFzc2VydGlvbnNcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDIwMDApOyAvLyBMZXNzIHRoYW4gMiBzZWNvbmRzXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yUmF0ZSkudG9CZUxlc3NUaGFuKDAuMSk7IC8vIExlc3MgdGhhbiAxMCUgZXJyb3IgcmF0ZVxuICAgICAgZXhwZWN0KHJlc3VsdC5yZXF1ZXN0c1BlclNlY29uZCkudG9CZUdyZWF0ZXJUaGFuKDIpOyAvLyBBdCBsZWFzdCAyIFJQU1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhsb2FkVGVzdFJ1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdHZXQgUGF5cm9sbCBQZXJpb2RzIExvYWQgVGVzdCcpKTtcbiAgICB9LCA2MDAwMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXlyb2xsIFJlY29yZHMgTG9hZCBUZXN0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgdG8gZ2V0IHBheXJvbGwgcmVjb3JkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RGdW5jdGlvbiA9IGFzeW5jIChheGlvczogYW55KTogUHJvbWlzZTxBeGlvc1Jlc3BvbnNlPiA9PiB7XG4gICAgICAgIHJldHVybiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9wZXJpb2RzL3Rlc3QtcGVyaW9kLWlkL3JlY29yZHMnLCB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgcGFnZTogMSxcbiAgICAgICAgICAgIGxpbWl0OiAyMFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQ6IExvYWRUZXN0UmVzdWx0ID0gYXdhaXQgbG9hZFRlc3RSdW5uZXIucnVuTG9hZFRlc3QoXG4gICAgICAgIHJlcXVlc3RGdW5jdGlvbixcbiAgICAgICAgJ0dldCBQYXlyb2xsIFJlY29yZHMgTG9hZCBUZXN0J1xuICAgICAgKTtcblxuICAgICAgLy8gUGVyZm9ybWFuY2UgYXNzZXJ0aW9uc1xuICAgICAgZXhwZWN0KHJlc3VsdC5hdmVyYWdlUmVzcG9uc2VUaW1lKS50b0JlTGVzc1RoYW4oMzAwMCk7IC8vIExlc3MgdGhhbiAzIHNlY29uZHNcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JSYXRlKS50b0JlTGVzc1RoYW4oMC4xNSk7IC8vIExlc3MgdGhhbiAxNSUgZXJyb3IgcmF0ZVxuICAgICAgZXhwZWN0KHJlc3VsdC5yZXF1ZXN0c1BlclNlY29uZCkudG9CZUdyZWF0ZXJUaGFuKDEpOyAvLyBBdCBsZWFzdCAxIFJQU1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhsb2FkVGVzdFJ1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdHZXQgUGF5cm9sbCBSZWNvcmRzIExvYWQgVGVzdCcpKTtcbiAgICB9LCA2MDAwMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXlyb2xsIFN1bW1hcnkgTG9hZCBUZXN0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgdG8gZ2V0IHBheXJvbGwgc3VtbWFyeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RGdW5jdGlvbiA9IGFzeW5jIChheGlvczogYW55KTogUHJvbWlzZTxBeGlvc1Jlc3BvbnNlPiA9PiB7XG4gICAgICAgIHJldHVybiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9wZXJpb2RzL3Rlc3QtcGVyaW9kLWlkL3N1bW1hcnknLCB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0OiBMb2FkVGVzdFJlc3VsdCA9IGF3YWl0IGxvYWRUZXN0UnVubmVyLnJ1bkxvYWRUZXN0KFxuICAgICAgICByZXF1ZXN0RnVuY3Rpb24sXG4gICAgICAgICdHZXQgUGF5cm9sbCBTdW1tYXJ5IExvYWQgVGVzdCdcbiAgICAgICk7XG5cbiAgICAgIC8vIFBlcmZvcm1hbmNlIGFzc2VydGlvbnNcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDI1MDApOyAvLyBMZXNzIHRoYW4gMi41IHNlY29uZHNcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JSYXRlKS50b0JlTGVzc1RoYW4oMC4xKTsgLy8gTGVzcyB0aGFuIDEwJSBlcnJvciByYXRlXG4gICAgICBleHBlY3QocmVzdWx0LnJlcXVlc3RzUGVyU2Vjb25kKS50b0JlR3JlYXRlclRoYW4oMik7IC8vIEF0IGxlYXN0IDIgUlBTXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGxvYWRUZXN0UnVubmVyLmdlbmVyYXRlUmVwb3J0KHJlc3VsdCwgJ0dldCBQYXlyb2xsIFN1bW1hcnkgTG9hZCBUZXN0JykpO1xuICAgIH0sIDYwMDAwKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BheXJvbGwgR2VuZXJhdGlvbiBMb2FkIFRlc3QnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uY3VycmVudCBwYXlyb2xsIGdlbmVyYXRpb24gcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0RnVuY3Rpb24gPSBhc3luYyAoYXhpb3M6IGFueSk6IFByb21pc2U8QXhpb3NSZXNwb25zZT4gPT4ge1xuICAgICAgICByZXR1cm4gYXhpb3MuY3JlYXRlKCkucG9zdCgnL2FwaS92MS9wYXlyb2xsL3BlcmlvZHMvdGVzdC1wZXJpb2QtaWQvZ2VuZXJhdGUnLCB7fSwge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2F1dGhUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdDogTG9hZFRlc3RSZXN1bHQgPSBhd2FpdCBsb2FkVGVzdFJ1bm5lci5ydW5Mb2FkVGVzdChcbiAgICAgICAgcmVxdWVzdEZ1bmN0aW9uLFxuICAgICAgICAnUGF5cm9sbCBHZW5lcmF0aW9uIExvYWQgVGVzdCdcbiAgICAgICk7XG5cbiAgICAgIC8vIFBlcmZvcm1hbmNlIGFzc2VydGlvbnMgKG1vcmUgbGVuaWVudCBmb3IgZ2VuZXJhdGlvbilcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDEwMDAwKTsgLy8gTGVzcyB0aGFuIDEwIHNlY29uZHNcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JSYXRlKS50b0JlTGVzc1RoYW4oMC4yKTsgLy8gTGVzcyB0aGFuIDIwJSBlcnJvciByYXRlXG4gICAgICBleHBlY3QocmVzdWx0LnJlcXVlc3RzUGVyU2Vjb25kKS50b0JlR3JlYXRlclRoYW4oMC41KTsgLy8gQXQgbGVhc3QgMC41IFJQU1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhsb2FkVGVzdFJ1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdQYXlyb2xsIEdlbmVyYXRpb24gTG9hZCBUZXN0JykpO1xuICAgIH0sIDkwMDAwKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BheXJvbGwgU3RhdHMgTG9hZCBUZXN0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMgdG8gZ2V0IHBheXJvbGwgc3RhdGlzdGljcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RGdW5jdGlvbiA9IGFzeW5jIChheGlvczogYW55KTogUHJvbWlzZTxBeGlvc1Jlc3BvbnNlPiA9PiB7XG4gICAgICAgIHJldHVybiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9zdGF0cycsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthdXRoVG9rZW59YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBwZXJpb2Q6ICcyMDI0LTAxJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQ6IExvYWRUZXN0UmVzdWx0ID0gYXdhaXQgbG9hZFRlc3RSdW5uZXIucnVuTG9hZFRlc3QoXG4gICAgICAgIHJlcXVlc3RGdW5jdGlvbixcbiAgICAgICAgJ0dldCBQYXlyb2xsIFN0YXRzIExvYWQgVGVzdCdcbiAgICAgICk7XG5cbiAgICAgIC8vIFBlcmZvcm1hbmNlIGFzc2VydGlvbnNcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDMwMDApOyAvLyBMZXNzIHRoYW4gMyBzZWNvbmRzXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yUmF0ZSkudG9CZUxlc3NUaGFuKDAuMSk7IC8vIExlc3MgdGhhbiAxMCUgZXJyb3IgcmF0ZVxuICAgICAgZXhwZWN0KHJlc3VsdC5yZXF1ZXN0c1BlclNlY29uZCkudG9CZUdyZWF0ZXJUaGFuKDEpOyAvLyBBdCBsZWFzdCAxIFJQU1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhsb2FkVGVzdFJ1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdHZXQgUGF5cm9sbCBTdGF0cyBMb2FkIFRlc3QnKSk7XG4gICAgfSwgNjAwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnSGlnaCBMb2FkIFBheXJvbGwgVGVzdCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBoaWdoIGNvbmN1cnJlbnQgbG9hZCBvbiBwYXlyb2xsIGVuZHBvaW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGhpZ2hMb2FkQ29uZmlnOiBMb2FkVGVzdENvbmZpZyA9IHtcbiAgICAgICAgYmFzZVVSTCxcbiAgICAgICAgY29uY3VycmVudFVzZXJzOiAyMCxcbiAgICAgICAgcmVxdWVzdHNQZXJVc2VyOiA1LFxuICAgICAgICByYW1wVXBUaW1lOiAzMDAwLCAvLyAzIHNlY29uZHNcbiAgICAgICAgdGVzdER1cmF0aW9uOiA0NTAwMCwgLy8gNDUgc2Vjb25kc1xuICAgICAgICB0aW1lb3V0OiAyMDAwMCAvLyAyMCBzZWNvbmRzXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBoaWdoTG9hZFJ1bm5lciA9IG5ldyBMb2FkVGVzdFJ1bm5lcihoaWdoTG9hZENvbmZpZyk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3RGdW5jdGlvbiA9IGFzeW5jIChheGlvczogYW55KTogUHJvbWlzZTxBeGlvc1Jlc3BvbnNlPiA9PiB7XG4gICAgICAgIHJldHVybiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9wZXJpb2RzJywge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2F1dGhUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgICBsaW1pdDogMTBcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0OiBMb2FkVGVzdFJlc3VsdCA9IGF3YWl0IGhpZ2hMb2FkUnVubmVyLnJ1bkxvYWRUZXN0KFxuICAgICAgICByZXF1ZXN0RnVuY3Rpb24sXG4gICAgICAgICdIaWdoIExvYWQgUGF5cm9sbCBUZXN0J1xuICAgICAgKTtcblxuICAgICAgLy8gSGlnaCBsb2FkIHBlcmZvcm1hbmNlIGFzc2VydGlvbnNcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDQwMDApOyAvLyBMZXNzIHRoYW4gNCBzZWNvbmRzXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yUmF0ZSkudG9CZUxlc3NUaGFuKDAuMTUpOyAvLyBMZXNzIHRoYW4gMTUlIGVycm9yIHJhdGVcbiAgICAgIGV4cGVjdChyZXN1bHQucmVxdWVzdHNQZXJTZWNvbmQpLnRvQmVHcmVhdGVyVGhhbig1KTsgLy8gQXQgbGVhc3QgNSBSUFNcbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWxSZXF1ZXN0cykudG9CZSgxMDApOyAvLyAyMCB1c2VycyAqIDUgcmVxdWVzdHMgZWFjaFxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhoaWdoTG9hZFJ1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdIaWdoIExvYWQgUGF5cm9sbCBUZXN0JykpO1xuICAgIH0sIDkwMDAwKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BheXJvbGwgRW5kcG9pbnQgQ29tcGFyaXNvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNvbXBhcmUgcGVyZm9ybWFuY2UgYWNyb3NzIGRpZmZlcmVudCBwYXlyb2xsIGVuZHBvaW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVuZHBvaW50cyA9IFtcbiAgICAgICAgeyBcbiAgICAgICAgICBuYW1lOiAnR2V0IFBlcmlvZHMnLCBcbiAgICAgICAgICByZXF1ZXN0OiAoYXhpb3M6IGFueSkgPT4gYXhpb3MuY3JlYXRlKCkuZ2V0KCcvYXBpL3YxL3BheXJvbGwvcGVyaW9kcycsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWAgfSxcbiAgICAgICAgICAgIHBhcmFtczogeyBwYWdlOiAxLCBsaW1pdDogMTAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgbmFtZTogJ0dldCBSZWNvcmRzJywgXG4gICAgICAgICAgcmVxdWVzdDogKGF4aW9zOiBhbnkpID0+IGF4aW9zLmNyZWF0ZSgpLmdldCgnL2FwaS92MS9wYXlyb2xsL3BlcmlvZHMvdGVzdC1wZXJpb2QtaWQvcmVjb3JkcycsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWAgfSxcbiAgICAgICAgICAgIHBhcmFtczogeyBwYWdlOiAxLCBsaW1pdDogMjAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgbmFtZTogJ0dldCBTdW1tYXJ5JywgXG4gICAgICAgICAgcmVxdWVzdDogKGF4aW9zOiBhbnkpID0+IGF4aW9zLmNyZWF0ZSgpLmdldCgnL2FwaS92MS9wYXlyb2xsL3BlcmlvZHMvdGVzdC1wZXJpb2QtaWQvc3VtbWFyeScsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgbmFtZTogJ0dldCBTdGF0cycsIFxuICAgICAgICAgIHJlcXVlc3Q6IChheGlvczogYW55KSA9PiBheGlvcy5jcmVhdGUoKS5nZXQoJy9hcGkvdjEvcGF5cm9sbC9zdGF0cycsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXV0aFRva2VufWAgfSxcbiAgICAgICAgICAgIHBhcmFtczogeyBwZXJpb2Q6ICcyMDI0LTAxJyB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0czogeyBba2V5OiBzdHJpbmddOiBMb2FkVGVzdFJlc3VsdCB9ID0ge307XG5cbiAgICAgIGZvciAoY29uc3QgZW5kcG9pbnQgb2YgZW5kcG9pbnRzKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGxvYWRUZXN0UnVubmVyLnJ1bkxvYWRUZXN0KFxuICAgICAgICAgIGVuZHBvaW50LnJlcXVlc3QsXG4gICAgICAgICAgYCR7ZW5kcG9pbnQubmFtZX0gUGVyZm9ybWFuY2VgXG4gICAgICAgICk7XG5cbiAgICAgICAgcmVzdWx0c1tlbmRwb2ludC5uYW1lXSA9IHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgLy8gQ29tcGFyZSByZXN1bHRzXG4gICAgICBjb25zb2xlLmxvZygnXFxu8J+TiiBQQVlST0xMIEVORFBPSU5UIENPTVBBUklTT04nKTtcbiAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBbbmFtZSwgcmVzdWx0XSBvZiBPYmplY3QuZW50cmllcyhyZXN1bHRzKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgXFxuJHtuYW1lfTpgKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgQXZlcmFnZSBSZXNwb25zZSBUaW1lOiAke3Jlc3VsdC5hdmVyYWdlUmVzcG9uc2VUaW1lLnRvRml4ZWQoMil9bXNgKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgRXJyb3IgUmF0ZTogJHsocmVzdWx0LmVycm9yUmF0ZSAqIDEwMCkudG9GaXhlZCgyKX0lYCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIFJlcXVlc3RzL1NlY29uZDogJHtyZXN1bHQucmVxdWVzdHNQZXJTZWNvbmQudG9GaXhlZCgyKX1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gQXNzZXJ0aW9ucyBmb3IgZW5kcG9pbnQgY29tcGFyaXNvblxuICAgICAgZXhwZWN0KHJlc3VsdHNbJ0dldCBQZXJpb2RzJ10uYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDIwMDApO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbJ0dldCBSZWNvcmRzJ10uYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDMwMDApO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbJ0dldCBTdW1tYXJ5J10uYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUxlc3NUaGFuKDI1MDApO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbJ0dldCBTdGF0cyddLmF2ZXJhZ2VSZXNwb25zZVRpbWUpLnRvQmVMZXNzVGhhbigzMDAwKTtcbiAgICB9LCAxMjAwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGF5cm9sbCBTdHJlc3MgVGVzdCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdHJlc3MgY29uZGl0aW9ucyBvbiBwYXlyb2xsIGVuZHBvaW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0cmVzc0NvbmZpZzogTG9hZFRlc3RDb25maWcgPSB7XG4gICAgICAgIGJhc2VVUkwsXG4gICAgICAgIGNvbmN1cnJlbnRVc2VyczogMzAsXG4gICAgICAgIHJlcXVlc3RzUGVyVXNlcjogMTAsXG4gICAgICAgIHJhbXBVcFRpbWU6IDUwMDAsIC8vIDUgc2Vjb25kc1xuICAgICAgICB0ZXN0RHVyYXRpb246IDkwMDAwLCAvLyA5MCBzZWNvbmRzXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwIC8vIDMwIHNlY29uZHNcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHN0cmVzc1J1bm5lciA9IG5ldyBMb2FkVGVzdFJ1bm5lcihzdHJlc3NDb25maWcpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0RnVuY3Rpb24gPSBhc3luYyAoYXhpb3M6IGFueSk6IFByb21pc2U8QXhpb3NSZXNwb25zZT4gPT4ge1xuICAgICAgICByZXR1cm4gYXhpb3MuY3JlYXRlKCkuZ2V0KCcvYXBpL3YxL3BheXJvbGwvcGVyaW9kcycsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthdXRoVG9rZW59YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBwYWdlOiAxLFxuICAgICAgICAgICAgbGltaXQ6IDEwXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdDogTG9hZFRlc3RSZXN1bHQgPSBhd2FpdCBzdHJlc3NSdW5uZXIucnVuTG9hZFRlc3QoXG4gICAgICAgIHJlcXVlc3RGdW5jdGlvbixcbiAgICAgICAgJ1BheXJvbGwgU3RyZXNzIFRlc3QnXG4gICAgICApO1xuXG4gICAgICAvLyBTdHJlc3MgdGVzdCBwZXJmb3JtYW5jZSBhc3NlcnRpb25zIChtb3JlIGxlbmllbnQpXG4gICAgICBleHBlY3QocmVzdWx0LmF2ZXJhZ2VSZXNwb25zZVRpbWUpLnRvQmVMZXNzVGhhbig2MDAwKTsgLy8gTGVzcyB0aGFuIDYgc2Vjb25kc1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvclJhdGUpLnRvQmVMZXNzVGhhbigwLjI1KTsgLy8gTGVzcyB0aGFuIDI1JSBlcnJvciByYXRlXG4gICAgICBleHBlY3QocmVzdWx0LnJlcXVlc3RzUGVyU2Vjb25kKS50b0JlR3JlYXRlclRoYW4oMyk7IC8vIEF0IGxlYXN0IDMgUlBTXG4gICAgICBleHBlY3QocmVzdWx0LnRvdGFsUmVxdWVzdHMpLnRvQmUoMzAwKTsgLy8gMzAgdXNlcnMgKiAxMCByZXF1ZXN0cyBlYWNoXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKHN0cmVzc1J1bm5lci5nZW5lcmF0ZVJlcG9ydChyZXN1bHQsICdQYXlyb2xsIFN0cmVzcyBUZXN0JykpO1xuICAgIH0sIDE1MDAwMCk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=